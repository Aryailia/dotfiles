#!/usr/bin/env sh
# https://stackoverflow.com/questions/6429515
stty -ixon -ixoff # Archaic with modern CPU/modem speeds. Reclaims C-q and C-s

alias    ab='abook --datafile "${HOME}/.config/abook/addressbook"'
alias   bcb='browser.sh menu bookmarks --browser clipboard'
alias   bgl='browser.sh gui link'
alias   bgb='browser.sh gui bookmarks'
alias   bge='browser.sh gui search'
alias   bml='browser.sh menu link'
alias   bmb='browser.sh menu bookmarks'
alias   bme='browser.sh menu search'
alias   btl='browser.sh terminal link'
alias   btb='browser.sh terminal bookmarks'
alias   bte='browser.sh terminal search'
alias    cw='cd_of sh -c '\''printf %s "$(dirname "$(command -v "$1")")"'\'' _'
alias    eb='browser.sh edit bookmarks'
alias    ee='browser.sh edit search'
alias    es='browser.sh edit search'
alias    ga='git add'
alias    gc='git commit --message'
alias   gdc='git diff --word-diff=color --word-diff-regex=.'
alias   gdl='git diff --color-moved=plain'
alias   gdw='git diff --word-diff=color'
alias    gn='git clone --recursive'
alias   glg="git log --graph --abbrev-commit --decorate --oneline --all"
alias    gp='git push --recurse-submodules=on-demand'
alias    gs='git status'
#alias  gcb='sh -c "
#  git checkout -b \"$1\"
#  git submodule foreach '\''git checkout -b \"$1\"'\''
#" _'
#alias    gu='git submodule update --remote --merge'
alias  grep='grep --color=auto'
alias     l='ls --color=auto --group-directories-first -h'
alias    ls='ls --color=auto'
alias    la='ls --color=auto --group-directories-first -hA'
alias   lal='ls --color=auto --group-directories-first -hAl'
alias    ll='ls --color=auto --group-directories-first -hl'
alias   mkf='sh -c '\''for x in "$@"; do
  name="$(echo "" | sed "s/^/$x/"; printf a)"; name="${name%?a}"
  touch -- "${name}"
  chmod 644 -- "${name}"
done'\'' _'
alias   mks='sh -c '\''for x in "$@"; do
  name="$(echo "" | sed "s/^/$x/"; printf a)"; name="${name%?a}"
  touch -- "${name}"
  chmod 755 -- "${name}"
done'\'' _'
alias    mt='file --dereference --brief --mime-type --'
alias    pm='package-manager.sh'
alias    rb='trash'
alias  rhkd='pkill -USR1 sxhkd'  # Sxhkd updates on receiving usr1 signal
alias    rx='xrdb ~/.Xresources'
#alias  rrc=''  # In individual rc files, reminder to not re-alias this
alias     t='tmux.sh'
alias     w='weather.sh'
alias     v='nvim'

alias c='cd_of sh -c '\''
  if [ -z "$1" ]; then
    namedpath.sh --interactive
    #return 1
  else
    namedpath.sh "$1"
  fi'\'' _ \
'

# Need to `tac | rev` in case
#alias f='cd_of sh -c '\''
#  eval "set -- $(sh -c "lf >/dev/tty" 2>&1 | tac | rev)"
#  a="$(printf %s\\n "$1" | tac | rev; printf a)"; a="${a%?a}"
#  printf %s "$a"
#  '\'' _; \
#'

alias f='cd_of sh -c '\''
  tmp="$(mktemp -p "${TMPDIR:-/tmp}")"
  trap "rm \"${tmp}\"" EXIT
  lf -last-dir-path="${tmp}" >&2
  # Shell removes the EOF character from cat on assignment here I believe
  b="$(cat "${tmp}"; printf a)"; b="${b%a}"
  printf %s\\n "$b" >&2
  printf %s "$b"
  '\'' _; \
'

#ffmpeg -i 'input' -1-6.mp4 -vn -acodec copy 'output'

# Android has no sudo
alias updateman='sh -c "sudo -V >/dev/null 2>&1" \
  && sudo makewhatis "${PREFIX}/usr/share/man" \
  || makewhatis "/usr/share/man"
'
alias list-path='printf %s\\n "${PATH}" | tr ":" "\n" | sort'

# -i list all Internet and x.25 network files
# -n prevents conversion of network numbers to host names (DNS translation)
# -l prevents conversion of user id numbers to login names
# -P prevents conversion of port numbers to port names
uname -o | grep -q 'GNU/Linux' && alias list-open-ports='lsof -i -nlP \
  | awk "{print \$9, \$8, \$1}" | sed "s/.*://" | sort -u'
uname -o | grep -q 'Android' && alias list-open-ports='lsof -i -nlP'
alias list-imes='sed -n "/^EnabledIMList=/{ s/^.*=//p; }" \
  ~/.config/fcitx/profile \
  | awk -v RS="," -v FS=":" "(\$2 ~ /True/){ print \$1; }"'
alias pipugradeall='python -m pip install --upgrade $(
  python -m pip list --outdated | awk "(NR > 2){ print \$0;}")'
#alias npmexec='printf "%s/%s" "$(npm bin)"'
alias rimeinstall='rime_frontend=fcitx-rime \
  bash $HOME/ime/rime-plum/rime-install'
